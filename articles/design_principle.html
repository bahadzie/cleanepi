<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cleanepi">
<title>Package Design vignette for {cleanepi} • cleanepi</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Package Design vignette for {cleanepi}">
<meta property="og:description" content="cleanepi">
<meta property="og:image" content="https://epiverse-trace.github.io/cleanepi/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Google tag (gtag.js) --><script async src="https://www.googletagmanager.com/gtag/js?id=G-XZ471458FQ"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-XZ471458FQ');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-dark"><div class="container">
    
    <a href="https://epiverse-trace.github.io/" class="external-link"><img src="../logo_white.svg" id="logo" alt="Epiverse-TRACE"></a>
    <a class="navbar-brand me-2" href="../index.html">cleanepi</a>

    <small class="nav-text text-muted me-auto version-number" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cleanepi.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/design_principle.html">Package Design vignette for {cleanepi}</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/epiverse-trace/cleanepi/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Package Design vignette for {cleanepi}</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/epiverse-trace/cleanepi/blob/HEAD/vignettes/design_principle.Rmd" class="external-link"><code>vignettes/design_principle.Rmd</code></a></small>
      <div class="d-none name"><code>design_principle.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="concept-and-motivation">Concept and motivation<a class="anchor" aria-label="anchor" href="#concept-and-motivation"></a>
</h2>
<p>In this document we outline the design decisions that will guide the
development strategies of the {cleanepi} R package, as well as some of
the reasoning, and possible pros and cons of each decision.</p>
<p>The data cleaning represents an important step for the success of the
downstream analysis. The steps involved in the cleaning process vary
depending on the data type and research goal. There are, however, some
steps that can be performed across almost all data types, independently
of the source of the data.</p>
</div>
<div class="section level2">
<h2 id="design-decisions">Design decisions<a class="anchor" aria-label="anchor" href="#design-decisions"></a>
</h2>
<p>The {cleanepi} R package is developed to provide functional
programming-style data cleansing tasks. We classified the data cleaning
operations into several categories, which we call
<strong>modules</strong>. This division is based on general goals from
data cleaning procedures that are generally expected by end users. Each
<strong>module</strong> will have one main function and other helper
functions to achieve a specific task. However, only the main function of
each module will be exported. This will provide the users with the
ability to perform the cleaning task individually when needed.</p>
<p><img src="../reference/figures/cleanepi_design_diagram.drawio.png"><!-- --></p>
<p>In the heart of {cleanepi}, there will be <code><a href="../reference/clean_data.html">clean_data()</a></code>,
a wrapper around all the modules (see Figure <span class="citation">@fig:1</span>). We expect it to be main function to be
called by users to clean their data. We considered some cleaning actions
as <strong>implicit</strong> (they will be performed whether the user
specified them or not), others as <strong>explicit</strong> (performed
only on the user’s request).</p>
<p>There will also be two surrogate functions:</p>
<ol style="list-style-type: decimal">
<li>
<code><a href="../reference/scan_data.html">scan_data()</a></code> to assess the data types found in every
column, and<br>
</li>
<li>
<code>print_report()</code> to display the report made from every
applied cleaning task.</li>
</ol>
</div>
<div class="section level2">
<h2 id="scope">Scope<a class="anchor" aria-label="anchor" href="#scope"></a>
</h2>
<p>{cleanepi} is an R package designed to clean, curate, and standardize
tabular datasets, with an emphasis on epidemiological data in
particular. The primary function of {cleanepi} is
<code><a href="../reference/clean_data.html">clean_data()</a></code>, which accepts as input the intended dataset
in the form of a <code>data.frame</code> or <code>linelist</code> object
and a <code>list</code> of operations to be performed on the dataset. In
the implementation of {cleanepi}, these operations are translated into
modules. Modules in the current version of {cleanepi} include the:</p>
<ul>
<li>standardization of column names,</li>
<li>removal of duplicates,</li>
<li>replacement of missing values with <code>NA</code>,</li>
<li>standardization of subject IDs,</li>
<li>standardization of date values,</li>
<li>replacement of existing values with pre-defined ones,</li>
<li>conversion of some values when required, and</li>
<li>transformation of some columns.</li>
</ul>
</div>
<div class="section level2">
<h2 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h2>
<p>The main functions in {cleanepi} return an object of type
<code>data.frame</code> or <code>linelist</code>. The report made from
all cleaning tasks is attached to this <code>data.frame</code> as an
attribute and can be accessed using the <code><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr()</a></code> function in
base R.</p>
<div class="section level3">
<h3 id="modules-in-cleanepi">Modules in {cleanepi}<a class="anchor" aria-label="anchor" href="#modules-in-cleanepi"></a>
</h3>
<p>In this section, we provide a detailed description of the way that
every module is built.</p>
<p><strong>1. Column names standardization</strong> This module contains
functions to harmonize the style and format of column names in the
target dataset, and optionally allows users to specify subset of focal
columns i.e. a list of column names to keep as-is.</p>
<ul>
<li>main function: <strong>standardize_column_names()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object; a
<code>vector</code> of focal column names (if not provided, all columns
will be checked for eventual standardization).</li>
<li>Output: the input object with standardized column names.</li>
<li>Report: a two-column table with the initial and current column names
for each updated column in the original dataset.</li>
<li>Mode: implicit.</li>
</ul>
<p><strong>2. Duplicates removal</strong> This module contains functions
to remove duplicated rows, columns, and constant columns.</p>
<ul>
<li>main function: <strong>remove_duplicates()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object; a
vector of target columns (the default option is to consider all
columns); remove empty rows (all rows by default), remove empty columns
(all columns by default), and remove constant. columns (all constant
columns by default).</li>
<li>Output: the input object with the effects of the specified
operations.</li>
<li>Report:<br>
● a two-column table with items and their values. Items include empty
rows, empty columns, and constant columns.<br>
● a table of removed duplicates.<br>
</li>
<li>Mode: implicit.</li>
</ul>
<p><strong>3. Replacement of missing values with
<code>NA</code></strong> This module is to standardize and unify the
text representing the missing values in the dataset.</p>
<ul>
<li>main function: <strong>replace_missing_char()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object; a
<code>vector</code> of column names (if not provided, the operation will
be performed across all columns); and a string specifying missing values
(the default value is null).</li>
<li>Output: the input object where all missing values are represented by
<code>NA</code>.</li>
<li>Report: a three-column table with index, column and value for each
missing item in the dataset.</li>
<li>Mode: implicit.</li>
</ul>
<p><strong>4. Date values standardization</strong> This module has
functions to standardize the format of dated-value columns and ensure
that all dates are inside a given timeframe.</p>
<ul>
<li>main function: <strong>standardize_dates()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object; a
<code>vector</code> of targeted date columns (if not provides, it
automatically figure out columns with date-values), tolerance_threshold
(the default value is 50%), format (the default value is NULL), and
timeframe (the default value is null).</li>
<li>Output: the input object with standardized date values (in the form
of <em>yyyy-mm-dd</em>).</li>
<li>Report:<br>
● a two-column table with the list of columns where the date values were
standardized.<br>
● a three-column table of index, column name, and values that are out of
the specified timeframe.<br>
</li>
<li>Mode: implicit.</li>
</ul>
<p><strong>5. Subject IDs standardization</strong> The functions in this
module are designed to check whether the values in the column that
unique identifies the subjects have the same format.</p>
<ul>
<li>main function: <strong>check_subject_ids()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object;
the name of id column; strings for prefix, suffix, and numerical range
within the ids.</li>
<li>Output: the input object with standardize subject ids.</li>
<li>Report: a two-column table with index and value of each subject id
that do not comply with the expected format.</li>
<li>Mode: explicit.</li>
</ul>
<p><strong>6. Dictionary based substitution </strong> This standardizes
entries in specific columns to certain values, such as replacing 1 with
male and 2 with female in gender column. It is also interoperable with
the <code>get_meta_data()</code> function from {readepi}.</p>
<ul>
<li>main function: <strong>clean_using_dictionary()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object;
and a data dictionary with the following column names: options, values,
column, and order.</li>
<li>Output: the input object where the specified options are replaced by
their provided values.</li>
<li>Report: a three-column table with index, column and value for each
unexpected value found in a targeted column.</li>
<li>Mode: explicit.</li>
</ul>
<p>Note that the <code><a href="../reference/clean_using_dictionary.html">clean_using_dictionary()</a></code> function will
return a warning when it detects unexpected values in the target columns
specified in the data dictionary. The unexpected values can be added to
the data dictionary using the <code>add_to_dictionary()</code>
function.</p>
<p><strong>7. Conversion </strong> This module contains functions to
convert numbers written in letters to numerical values, and it is
interoperable with the {numberize} package.</p>
<ul>
<li>main function: <strong>convert_to_numeric()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object; a
vector of column names to be converted into numeric; and the output of
the <code><a href="../reference/scan_data.html">scan_data()</a></code> function.</li>
<li>Output: the input object where the values in the target columns are
converted into numeric.</li>
<li>Report: a three-column table with index, column and value for each
unrecognized value in the dataset (strings that could not be converted
into numeric).</li>
<li>Mode: explicit.</li>
</ul>
<p>Note that <code>convert_to_numeric()</code> will issue a warning for
unexpected values and return them in the report.</p>
<p><strong>8. Transformation </strong> This is used to do various
specialized operations related to epidemiological data analytics. The
current implementation includes the following functions.</p>
<ul>
<li>main function: <strong>calculate_age_in()</strong><br>
</li>
<li>Input: a <code>data.frame</code> or <code>linelist</code> object;
the name of the column of interest; the reference date; and the time
unit (possible values are days, weeks, months, or years).</li>
<li>Output: the input object with the clean data with an additional age
column with values in the intended time unit.</li>
<li>Report: none.</li>
<li>Mode: explicit.</li>
</ul>
</div>
<div class="section level3">
<h3 id="surrogate-functions">Surrogate functions<a class="anchor" aria-label="anchor" href="#surrogate-functions"></a>
</h3>
<p>There are also two surrogate functions: <code><a href="../reference/scan_data.html">scan_data()</a></code> for
providing a quick summary of the data, including the percentage of
values of type character, numeric, missing, logical, date in every
column, and <code>print_report()</code> for displaying reports of the
cleaning operations performed on the dataset.</p>
</div>
</div>
<div class="section level2">
<h2 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h2>
<p>The modules and surrogate functions will depend mainly on the
following packages:</p>
<p><a href="https://github.com/epiverse-trace/numberize" class="external-link">{numberize}</a>, <a href="https://CRAN.R-project.org/package=dplyr" class="external-link">{dplyr}</a>, <a href="https://CRAN.R-project.org/package=maggritr" class="external-link">{maggritr}</a>, <a href="https://CRAN.R-project.org/package=linelist" class="external-link">{linelist}</a>, <a href="https://CRAN.R-project.org/package=janitor" class="external-link">{janitor}</a>, <a href="https://CRAN.R-project.org/package=matchmaker" class="external-link">{matchmaker}</a>,
<a href="https://CRAN.R-project.org/package=dplyr" class="external-link">{lubridate}</a>, <a href="https://CRAN.R-project.org/package=epitrix" class="external-link">{epitrix}</a>, <a href="https://CRAN.R-project.org/package=arsenal" class="external-link">{arsenal}</a>, <a href="https://CRAN.R-project.org/package=naniar" class="external-link">{naniar}</a>, <a href="https://CRAN.R-project.org/package=glue" class="external-link">{glue}</a>, <a href="https://CRAN.R-project.org/package=stringr" class="external-link">{stringr}</a>, <a href="https://CRAN.R-project.org/package=snakecase" class="external-link">{snakecase}</a>, <a href="https://CRAN.R-project.org/package=readr" class="external-link">{readr}</a>, and <a href="https://CRAN.R-project.org/package=R.utils" class="external-link">{R.utils}</a>.</p>
<p>The functions will require all other packages that needed in the
package development process including:</p>
<p><a href="https://CRAN.R-project.org/package=checkmate" class="external-link">{checkmate}</a>, <a href="https://CRAN.R-project.org/package=kableExtra" class="external-link">{kableExtra}</a>,
<a href="https://CRAN.R-project.org/package=bookdown" class="external-link">{bookdown}</a>, <a href="https://CRAN.R-project.org/package=rmarkdown" class="external-link">{rmarkdown}</a>, <a href="https://CRAN.R-project.org/package=testthat" class="external-link">{testthat}</a> (&gt;=
3.0.0), <a href="https://CRAN.R-project.org/package=knitr" class="external-link">{knitr}</a>,
<a href="https://CRAN.R-project.org/package=lintr" class="external-link">{lintr}</a></p>
</div>
<div class="section level2">
<h2 id="contribute">Contribute<a class="anchor" aria-label="anchor" href="#contribute"></a>
</h2>
<p>There are no special requirements to contributing to {cleanepi},
please follow the <a href="https://github.com/epiverse-trace/.github/blob/main/CONTRIBUTING.md" class="external-link">package
contributing guide</a>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Karim Mané.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
